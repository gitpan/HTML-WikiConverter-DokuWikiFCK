HTML::WikiConverter::DokuWikiFCK

This package includes DokuWikiFCK.pm, a perl extension to DokuWik.pm
and fckg a plugin which supports the new syntax created by DokuWikiFCK.pm.
fckg includes a dedicated version of the fckw plugin, altered for use with 
for DokuWikiFCK.pm. Both fckw and fckg cannot both be installed at the
same time.  Similarly, if you have installed an earlier version of DokuWikiFCK
with a 'styles' plugin, you cannot run the 'styles' plugin at the same
time as fckg.  You can disable these plugins by making them unreadable and
non executable:  
            chmod a-rwx styles
            chmod a-rwx fckw  


1. INSTALLATION

a. FIRST-TIME INSTALLATION
  A first-time installation is best done using CPAN:

    perl -MCPAN -e 'install HTML::WikiConverter::DokuWikiFCK'
    
    This will install all of the Perl dependencies you need as well as
    the fckg DokuWiki plugin. 
   		
    You should be prepared to provide the installer with the
    full path to your DokuWiki plugins, for instance:

             /var/www/html/dokuwiki/lib/plugins

    The fckg plugin will then be installed in your plugins directory.
    You will also be asked if you would like to replace the DokuWiki  
    mediamanager with a revised version which is needed for the FCKeditor
    The revised version is entirely compatible with DokuWiki. Your 
    original DokuWiki mediamanager.php will be backed up.


b. SUBSEQUENT OR MANUAL INSTALLATION
    
    The DokuWikiFCK package can be downloaded from CPAN at:

          http://search.cpan.org/search?module=HTML::WikiConverter::DokuWikiFCK

    To install, the standard instructions are:

        gzip -dc  HTML-WikiConverter-DokuWikiFCK-0.<nn>.tar.gz  | tar -xvf -
               OR
        tar -xzf HTML-WikiConverter-DokuWikiFCK-0.<nn>.tar.gz

        perl Makefile.PL
        make
        make test
        make install
  
   
If you have previously installed DokuWikiFCK, consult this README document.  If the only
change is to DokuWikiFCK.pm, you can simply replace the old version of DokuWikiFCK.pm
with this new one.  You should normally find it in the following perl5 directory:

    usr/lib/perl5/site_perl/<perl_version>/HTML/WikiConverter


c. A COMPLETELY MANUAL INSTALL

DokuWikiFCK.pm subclasses DokuWiki.pm in order to give additional
functionality to the FCK editor.  First, place DokuWikiFCK.pm in the perl5 directory,
where DokuWiki.pm is installed. This should be: 
    usr/lib/perl5/site_perl/<perl_version>/HTML/WikiConverter
Then install the fckg plugin in the DokuWiki plugins directory.

The following perl modules are required:
	HTML::WikiConverter
	HTML::WikiConverter::DokuWiki
        HTML::WikiConverter::DokuWikiFCK (included in this package)


2. SPACE-BAR POSITIONING

The FCK Editor supports positioning of text and images using the Outdent, Indent,
and Justification icons.  Justification is left, right, and center.  Outdent
and Indent position elments at 40 pixel intervals. DokuWikiFCK has extended this
functionality to enable positioning by use of the space-bar.  Space-bar positioning
is on by default. 

To disable space-bar positioning, set the Perl variable $SPACEBAR_NUDGING to 1:
  my $SPACEBAR_NUDGING = 1;
This will be found at the top of the DokuWikiFCK.pm file.


3. INSERTING AND UPLOADING IMAGES

In the current version of fckw, the DokuWiki media manager is used for uploading files
and the FCKEditor media manager is used for inserting files in the FCK editor's
editing space.

To implement inserting and uploading of images:
	1.replace the copy of DokuWiki's mediamanager.php in tpl/<default> with 
the one included in this package. 

        2. create a userfiles directory in your doucment root directory.  Inside userfiles,
create a symbolic link that points to the dokuwiki media directory:
             userfiles
                image -> <dokuwiki_directory>/data/media


4. USING THE MEDIA MANAGER IN MULTIPLE DOKUWIKI INSTALLATIONS
If you are running more than one dokuwiki on your server,each using DokuWikiFCK, and if 
each has its own media directory, you will have to create a 'userfiles' directory
for each installation, and each 'userfiles' will need an 'image' link to
its own media directory. The way to do this is as follows:

  1. in each installation's 'lib/plugins/fckg/fckeditor' directory, create 'userfiles'
  2. in each  'userfiles' create a link to its media directory
  3. go to fckg/fckeditor/editor/filemanager/connectors/php.config.php and in
     config.php make the following edits:

     ADD:
     $UserFilesRealPath =  realpath(dirname(__FILE__)).'/../../../../userfiles/';

     CHANGE:
    // Path to user files relative to the document root.
    //$Config['UserFilesPath'] =  '/userfiles/' ;
      $Config['UserFilesPath'] = $UserFilesRealPath; 

    //$Config['UserFilesAbsolutePath'] = ''
      $Config['UserFilesAbsolutePath'] = $UserFilesRealPath;



5. FCKEDITOR TOOLBAR

The following FCKEditor Toolbar items are supported:

FCKConfig.ToolbarSets["Dokuwiki"] = [   
  ['Bold','Italic','Underline','StrikeThrough','-','Subscript','Superscript'],   
  ['OrderedList','UnorderedList'],['Outdent','Indent'],   
  ['JustifyCenter','JustifyLeft','JustifyRight'],
  ['Table','Rule', 'Blockquote'], ['Smiley', 'SpecialChar'], [],  
  ['Cut','Copy','Paste','PasteText' ],   
  ['Undo','Redo','RemoveFormat', '-','Find'],   
  '/',   
  ['Style'],
  ['TextColor','BGColor'],['FontFormat','FontName','FontSize'],   
   ['Link','Unlink'], ['Image'],  
  '/',
  ['Source','-','About']   
] ;  



6.  LOCK TIME OUT
The Editor Form has a checkbox which disables the lock timer.  This prevents the timeout alert
from popping up every 15 minutes.  The Configuration Manager has a setting for the fckg plugin
which enables the administrator to enter a comma separated list of groups which have permission
to disable the lock timer.  The default setting is ANY, which means that any user can disable
the lock timer.

DokuWiki normally issues its time out warning after 15 minutes of keyboard
inactivity.  But the FCKEditor interferes with this monitoring, so DokuWiki believes that
there is no keyboard activity even when there is.  Because DokuWiki isn't able to detect
keyboard activity, it doesn't make automatic backups, which it otherwise does after 
every minute of keyboard activity.  This version of DokuWikiFCK makes automatic backups
every three minutes when the user selects the chekbox that sets the lock timer to off. 

7. DokuWiki SYNTAX PLUGIN SUPPORT
There is a toolbar item which enables the user to buffer syntax plugin syntax, so that the
syntax behavors correctly.  The toolbar icon is an electric plug.  Use the mouse to
select the plugin's syntax and the click on the plugin icon.  A small dialog will appear
asking for the name of the plugin.  Enter the name and click OK. DokuWikiFCK will 
identify the plugin from its syntax;it uses the same code as DokuWiki uses to
identify plugins.  DokuWikiFCK will use the name you give in the dialogue only as a
last resort. 

If you have  previously used the plugin tool to identify a plugin, you can remove the DokuWikiFCK
identifying code by re-selecting the plugin syntax, clicking on the plugin tool,
leaving the dialog box empty, and clicking OK.
  

8. EDITOR SUPPORT
DokuWikiFCK now has a transparent facility for switching between the FCKeditor and the DokuWiki editor.
There are always buttons on screen which enable the user to switch to the other editor.  When switching
from the FCKeditor to the DokuWiki editor, you are given the option of backing up the FCK file and
starting the DokuWiki session with a clean file of the same name.  The FCK file is saved to 
numbered files with the format
           filename_fck_<n>
where <n> is the number of the backup file.

This means that the user can choose which editor to use for a particular project.  One scenario
might be to start with basic DokuWiki text editing and then switch to FCK for layout and design.


Myron Turner
turnermm02@shaw.ca

